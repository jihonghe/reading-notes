# 数据库系统的标准结构

## 1. 典型的数据库系统的结构抽象

一个典型的数据库系统通常分为以下四层：

- 数据库(DB)
- 数据库管理系统(DBMS)
- 应用程序(DBAP)
- 应用程序用户(USER)

## 2. DBMS管理数据的三个层次

- **外部层次(External Level)**：又称为**用户层次(User Level)**。用户层次涉及的数据属于全局数据中的某一部分，用户可以对这部分数据进行查看与处理。实际上，外部层次的数据对应的就是数据库系统的DBAP中的数据，用户即为DBAP的用户。例如：在图书馆里系统中的用户注册程序，图书借阅程序等，用户所接触到的数据都是全局数据中的一部分。
- **逻辑层次(Logic Level)**：又称为**概念层次(Conceptual Level)**和**全局层次**。**概念层次体现的是数据之间内在联系**。概念层次是从全局角度管理数据，即对数据进行逻辑操作，包括管理数据的关联约束，所涉及的数据是全量数据。
- **物理层次(Physical Level)**：又称为**内部层次(Internal Level)**。物理层次反映的是存储在物理介质上的数据，涉及数据的存储路径、存储方式及索引方式等，而数据的存储路径、存储方式及索引方式取决于DBMS，因此物理层次与DBMS相关。

**外部层次、逻辑层次及物理层次的关系**：用户通过使用应用程序(DBAP)实现对外部层次数据的访问与控制，DBAP会将用户涉及数据的操作转化为逻辑层次的操作，逻辑层次进一步的将数据操作作用到物理层次，最终实现了用户对数据的访问控制。

## 3. 视图(数据)与模式

- **模式(Schema)**
模式是对数据库中的数据所进行的一种结构性描述，也就是数据库中某一类数据的结构信息
- **视图(View)/数据(Data)**：数据库中以某种表现形式所展示的数据

**模式与视图的关系**：模式描述了视图的数据结构信息，视图按照模式的数据结构信息展示数据。简单说，**模式就是数据表的表信息的描述，视图就是数据表中的数据。**。具体如下图：
[schema_view](../static/images/shcema_view.png)

## 4. 三级模式(三级视图)与两层映像

从结构角度而言，称为三级模式；从数据角度，称为三级视图。

- **三级模式**
  - **外模式(External Schema)**：又称为**子模式**，对应的为**外部视图(External View)**，即为DBMS的**外部层次(External Level)**。
  - **概念模式(Conceptual Schema)**：对应的视图为**概念视图(Concepatual View)**，即为DBMS的**概念层次**。
  - **内模式(Internal Schema)**：对应的视图为**内部视图(Internal View)**，即为DBMS的**物理层次**。
  三者关系如下：
  [schema_view_02](../static/images/schema_view_02.png)
- **两层映像**
  - **E-C Mapping**：全称为`External Schema - Conceptual Schema Mapping`，作用如下：
    - 将外模式映射为概念模式，从而支持实现数据概念视图向外部视图的转换
    - 便于用户观察和使用
  - **C-I Mapping**：全称为`Conceptual Schema - Internal Schema Mapping`，作用如下：
    - 将概念模式映射为内模式，从而支持实现数据概念视图向内部视图的转换
    - 便于计算及进行存储和处理

  关于映像与模式的关系，如下图所示：
  [schema_view_03](../static/images/schema_view_03.png)

## 5. 数据库系统的标准结构

### 5.1 数据库系统的标准结构图

[standard_structure](static/../../static/images/standard_structure.png)

### 5.2 为什么要按照标准结构对数据库系统进行抽象

因为通过对数据库系统进行抽象分层，可以保证在任何一层发生变化时，通过两层映像，其他层不必作出必要的改变，将影响降到最低。

按照标准结构对数据库系统进行抽象，实现了两个独立性：

- **逻辑数据独立性**：指的是当概念模式发生改变时，可以不改变外部模式，只需改变E-C Mapping，从而无需改变应用程序，达到数据与程序的解耦
- **物理数据独立性**：当内部模式发生改变时，可以不改变概念模式，只需改变C-I Mapping。基于此，无需改变外部模式，从而无需改变应用程序。

### 5.3 关于概念模式与内模式的变化示例

- **概念模式发生变化**：概念模式对应的是数据表的数据结构，当数据表结构发生变化时，通过改变E-C Mapping即可保证逻辑数据的独立性。
- **内模式发生变化**：内模式对应的是物理层次，物理层次与DBMS相关，因此可能的变化可以是DBMS的更换，而DBMS发生变化时只需通过改变C-I Mapping即可保证物理数据的独立性，并且不影响上层模式。
